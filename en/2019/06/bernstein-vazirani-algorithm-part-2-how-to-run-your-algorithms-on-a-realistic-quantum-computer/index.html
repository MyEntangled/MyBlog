<!DOCTYPE html>
<html lang="en-us" />
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />


    <title>Bernstein-Vazirani algorithm (Part 2): How to run your algorithms on a realistic quantum computer &middot; My Entangled: Blogging on Quantum Information, Quantum Algorithms and Quantum Computing</title>

    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="https://myentangled.com/favicon.ico" />
    <link rel="canonical" href="https://myentangled.com/en/2019/06/bernstein-vazirani-algorithm-part-2-how-to-run-your-algorithms-on-a-realistic-quantum-computer/" />

     <meta name="description" content="In the last part of the previous series, Deutsch algorithm, I introduced a manual way to construct the oracle. That oracle must be built from matrix because the" /> 

     
    
    <meta name="twitter:card" content="summary_large_image"/>
    <meta name="twitter:image" content="https://myentangled.com/uploads/Bernstein-Vazirani%20Algorithm/cover.png"/>
    
 
    <meta name="twitter:title" content="Bernstein-Vazirani algorithm (Part 2): How to run your algorithms on a realistic quantum computer"/>
    <meta name="twitter:description" content="In the last part of the previous series, Deutsch algorithm, I introduced a manual way to construct the oracle. That oracle must be built from matrix because the"/>
    <meta name="twitter:url" content="https://myentangled.com/en/2019/06/bernstein-vazirani-algorithm-part-2-how-to-run-your-algorithms-on-a-realistic-quantum-computer/" />
    <meta name="twitter:site" content="@TrongDu81761446"/>

    <meta property="og:site_name" content="My Entangled: Blogging on Quantum Information, Quantum Algorithms and Quantum Computing" />
    <meta property="og:title" content="Bernstein-Vazirani algorithm (Part 2): How to run your algorithms on a realistic quantum computer &middot; " />
    <meta property="og:url" content="https://myentangled.com/en/2019/06/bernstein-vazirani-algorithm-part-2-how-to-run-your-algorithms-on-a-realistic-quantum-computer/" />
    

    <meta property="og:type" content="article" />
    <meta property="og:description" content="In the last part of the previous series, Deutsch algorithm, I introduced a manual way to construct the oracle. That oracle must be built from matrix because the" />

    <meta property="article:published_time" content="2019-06-07T15:30:16&#43;07:00" />
    <meta property="article:tag" content="project" /><meta property="article:tag" content="Bernstein-Vazirani algorithm" /><meta property="article:tag" content="Deutsch algorithm" />

    <meta property="og:image" content="https://myentangled.com/uploads/Bernstein-Vazirani%20Algorithm/cover.png"/>


    <meta name="generator" content="Hugo 0.54.0" />

    <!-- Stylesheets -->
    <link rel="stylesheet" type="text/css" href="https://myentangled.com/built/screen.css" /> 
    <link rel="stylesheet" type="text/css" href="https://myentangled.com/css/casper-two.css" /> 
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" />
    

     

    
    <script type="text/javascript" async
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
  jax: ["input/MathML","output/HTML-CSS"],
  extensions: ["mml2jax.js","MathMenu.js", "MathZoom.js"],
  "HTML-CSS": {
    imageFont: null,
    linebreaks: { automatic: true }
  },
  MathMenu: {
    showLocale: false,
    showRenderer: false
  },    
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'],['\\[','\\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
  });

  MathJax.Hub.Queue(function() {
    
    
    
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });

  MathJax.Hub.Config({
  
  TeX: { equationNumbers: { autoNumber: "AMS" } }
  });
</script> 
    


    <link href="https://fonts.googleapis.com/css?family=Noto+Sans+KR|Roboto" rel="stylesheet" type='text/css'>

    <style>
    p{
        font-family: 'Roboto', sans-serif;
    }
    body {}
    code {}
    }
    </style>

</head>


<body class="post-template">
  <div class="site-wrapper"> 

<header class="site-header outer">
  <div class="inner">
    <nav class="site-nav">
      <div class="site-nav-left">

        <ul class="nav" role="menu">
        
        
        
            <li class="" role="menuitem">
              <a href="/en/">Home</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="/en/categories/quantum-information">Quantum Information</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="/en/categories/quantum-algorithms/">Quantum Algorithms</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="/en/tags/project/">Projects</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="/en/2019/04/who-am-i-and-what-the-fish-is-this-blog/">About me</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="/en/categories/stories/">Stories</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="/en/2019/05/study-resources/">Resources</a>
            </li>
        
            <li class="" role="menuitem">
              <a href="/vn/">Tiếng Việt</a>
            </li>
        
      </ul></div>

      <div class="site-nav-right">
        <div class="social-links">
                    

                    <a class="social-link social-link-tw" href="https://twitter.com/TrongDu81761446" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg></a>

                    <a class="social-link" href="https://github.com/myentangled" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a>

                    <a class="social-link" href="https://www.linkedin.com/in/trong-duong-0a75b6171" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 50 512 512"><path d="M150.65,100.682c0,27.992-22.508,50.683-50.273,50.683c-27.765,0-50.273-22.691-50.273-50.683 C50.104,72.691,72.612,50,100.377,50C128.143,50,150.65,72.691,150.65,100.682z M143.294,187.333H58.277V462h85.017V187.333z M279.195,187.333h-81.541V462h81.541c0,0,0-101.877,0-144.181c0-38.624,17.779-61.615,51.807-61.615 c31.268,0,46.289,22.071,46.289,61.615c0,39.545,0,144.181,0,144.181h84.605c0,0,0-100.344,0-173.915 s-41.689-109.131-99.934-109.131s-82.768,45.369-82.768,45.369V187.333z" /></svg></a>

                    
        </div>  
            
      </div>

    </nav>  

  </div>
</header>

<main id="site-main" class="site-main outer" role="main">
  <div class="inner">
    
      <article class="post-full post"> 
    <header class="post-full-header">
        <section class="post-full-meta">
            <time class="post-full-meta-date" datetime="2019-06-07">7 June 2019</time>
                <span class="date-divider">/</span> <a href="/en/tags/project/">#project</a>&nbsp;<a href="/en/tags/bernstein-vazirani-algorithm/">#Bernstein-Vazirani algorithm</a>&nbsp;
        </section>
        <h1 class="post-full-title">Bernstein-Vazirani algorithm (Part 2): How to run your algorithms on a realistic quantum computer</h1>
    </header>
    
    <figure class="post-full-image" style="background-image: url(https://myentangled.com/uploads/Bernstein-Vazirani%20Algorithm/cover.png)">
    </figure>

    <section class="post-full-content">
        <div class="kg-card-markdown">
        

<p>In the last part of the previous series, Deutsch algorithm, I introduced a manual way to construct the oracle. That oracle must be built from matrix because the oracle function is undeterminate except for the outcome. In Bernsterin-Vazirani problem, the function is, on the other hand, clearly stated: $f(\mathbf{x}) = \mathbf{s}\cdot\mathbf{x}$. So, it&rsquo;s unnecessary to repeat the previous procedure; instead, we&rsquo;ll build the oracle without using matrices by understanding what the function really do. There are two slightly different way to build the oracle, and we&rsquo;ll also execute the whole algorithms on both simulators and IBM&rsquo;s quantum computers.</p>

<h4 id="python-qiskit">Python &amp; Qiskit</h4>

<p>From now on, I&rsquo;ll switch to write demo code using Python and Qiskit, a well-designed Python-based library for quantum computing. The library also supports the use of realized quantum computers developed by IBM so that you can execute your algorithm within your computer simulator or by requesting IBM to do that for you.</p>

<p>There is a great &ldquo;<a href = 'https://qiskit.org/documentation/getting_started.html'>Getting Started</a>&rdquo; for the library. You can pip install the library and follow the instruction above to get familiar with its syntax. It&rsquo;s not difficult at all. Another suggestion is that you should look for basic tutorials in Qiskit Github as well.</p>

<p>Then we're gonna come straight into the implementation: Given a bitstring $\mathbf{s}$, we need to initialize our computation with at least $n$ qubits, where $n$ is the length of $\mathbf{s}$, plus $1$ ancilla qubit for phase kickback. 
 <table class="highlighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%"><code class="language-python" data-lang="python">1
2
3</code></pre></div></td><td class="code"><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><code class="language-python" data-lang="python"><span></span><span style="color: #f8f8f2">nQubits</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">13</span>
<span style="color: #f8f8f2">s</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">101</span> <span style="color: #75715e">#whose bitstring is 1100101</span>
<span style="color: #66d9ef">assert</span> <span style="color: #f8f8f2">s</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">s</span> <span style="color: #f92672">%</span> <span style="color: #f8f8f2">(</span><span style="color: #ae81ff">2</span><span style="color: #f92672">**</span><span style="color: #f8f8f2">nQubits),</span> <span style="color: #e6db74">&quot;s has binary representation of length exceeding nQubits&quot;</span> 
</code></pre></div>
</td></tr></table> </p>

<p>Next we'll create the backbone of the circuit:
 <table class="highlighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%"><code class="language-python" data-lang="python">1
2
3
4
5</code></pre></div></td><td class="code"><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><code class="language-python" data-lang="python"><span></span><span style="color: #75715e"># Initialize the circuit</span>
<span style="color: #f8f8f2">qr</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">QuantumRegister(nQubits</span> <span style="color: #f92672">+</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">)</span> <span style="color: #75715e">## 1 for ancilla</span>
<span style="color: #f8f8f2">cr</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">ClassicalRegister(nQubits)</span>
<span style="color: #f8f8f2">circuitName</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;BernsteinVazirani&quot;</span>
<span style="color: #f8f8f2">bvCircuit</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">QuantumCircuit(qr,</span> <span style="color: #f8f8f2">cr)</span> 
</code></pre></div>
</td></tr></table> </p>

<p>A set of gates for preparation is also applied at the beginning. It is very common to use this subroutine in a variety of quantum algorithms
 <table class="highlighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%"><code class="language-python" data-lang="python">1
2
3
4
5
6
7
8
9</code></pre></div></td><td class="code"><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><code class="language-python" data-lang="python"><span></span><span style="color: #75715e"># Prepare the ancilla qubit</span>
<span style="color: #f8f8f2">bvCircuit</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">x(qr[</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">])</span>
<span style="color: #f8f8f2">bvCircuit</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">h(qr[</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">])</span>

<span style="color: #75715e"># Raise every qubit of the first register to the Hadamard state</span>
<span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(nQubits):</span>
    <span style="color: #f8f8f2">bvCircuit</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">h(qr[i])</span>
    
<span style="color: #f8f8f2">bvCircuit</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">barrier()</span> 
</code></pre></div>
</td></tr></table> </p>

<h4 id="oracle-construction">Oracle construction</h4>

<p> Recalling that $U_f|x\rangle|y\rangle = |x\rangle|y\oplus f(x)\rangle$ is no other than a <b>NOT</b> gate acting on $|y\rangle$ controlled by the value of $f(x)$. Therefore, we need to come up with a way to find  out every $\mathbf{x}$ that $f(\mathbf{x})=1$, which is equivalent to $\mathbf{s}\cdot\mathbf{x}=1$. The dot product $s_1s_2...s_n \cdot x_1x_2...x_n$ can only be equal $1$ when $s_i = x_i = 1$ for an odd number of $i$ indexes. All the three other types of $s_i,x_i$ pair do not contribute to the product result. So, what we need to do is to apply $CNOT |x_i\rangle|y\rangle$ where $s_i = 1$. It's easily to see that the operator is a <b>NOT</b> gate acting on the ancilla when $s_i= x_i = 1$. Moreover, the value $y$ will experience a net change only if the <b>NOT</b> gate is applied an odd number of times. Sounds a little bit complicated? See the code to figure it out.
 <table class="highlighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%"><code class="language-python" data-lang="python">1
2
3</code></pre></div></td><td class="code"><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><code class="language-python" data-lang="python"><span></span><span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(nQubits):</span>
    <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(s</span> <span style="color: #f92672">&amp;</span> <span style="color: #f8f8f2">(</span><span style="color: #ae81ff">1</span> <span style="color: #f92672">&lt;&lt;</span> <span style="color: #f8f8f2">i)):</span> <span style="color: #75715e"># The whole condition simpllifies to &quot;if (s[i] == 1):&quot;, we just pretend to not have a prior knowledge of s</span>
        <span style="color: #f8f8f2">bvCircuit</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">cx(qr[i],</span> <span style="color: #f8f8f2">qr[</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">])</span> 
</code></pre></div>
</td></tr></table> </p>

<h4 id="finish-it-up">Finish it up</h4>

<p><p> The last gates are applied to retrieve the bitstring as well as get the circuit returned to a standard state. Here I draw out the circuit with &ldquo;latex&rdquo; backend. If you haven&rsquo;t installed LaTeX locally, you can either use &ldquo;mpl&rdquo; for matplotlib backend or default &ldquo;text&rdquo; backend.
 <table class="highlighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%"><code class="language-python" data-lang="python"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</code></pre></div></td><td class="code"><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><code class="language-python" data-lang="python"><span></span><span style="color: #f8f8f2">bvCircuit</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">h(qr[</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">])</span>
<span style="color: #f8f8f2">bvCircuit</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">x(qr[</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">])</span>

<span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(nQubits):</span>
    <span style="color: #f8f8f2">bvCircuit</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">h(qr[i])</span>
<span style="color: #f8f8f2">bvCircuit</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">barrier(qr)</span>

<span style="color: #f8f8f2">bvCircuit</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">measure(qr[:</span><span style="color: #f92672">-</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">],cr)</span>

<span style="color: #f8f8f2">bvCircuit</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">draw(output</span><span style="color: #f92672">=</span><span style="color: #e6db74">&#39;latex&#39;</span><span style="color: #f8f8f2">)</span> 
</code></pre></div>
</td></tr></table> </p>
<img src="/uploads/Bernstein-Vazirani Algorithm/code circuit.png" alt="Example image" /></p>

<p><p> I&rsquo;ll analyze the circuit a little bit further. Mathematically, it&rsquo;s not so difficult to prove the equality $(\mathbf{H}_0\otimes\mathbf{H}_1) \mathbf{CNOT}_{0,1} (\mathbf{H}_0\otimes\mathbf{H}_1) = \mathbf{CNOT}_{1,0}$ </p>
<img src="/uploads/Bernstein-Vazirani Algorithm/equivalent circuit.png" alt="Example image" />
<p> Squeezing the ancilla between two $X$ gates, we get </p>
<img src="/uploads/Bernstein-Vazirani Algorithm/equivalent circuit_2.png" alt="Example image" /></p>

<p>The figure above obviously points out that every qubit that has a <strong>CNOT</strong> connnection with the ancilla will be changed to the state $|1\rangle$ at the end of the circuit. The positions of changed qubits corresponds to the positions of the string $s$ whose bits are $1$. This is absolutely what we want.</p>

<h4 id="executing-the-algorithm-on-different-calculating-backends">Executing the algorithm on different calculating backends</h4>

<p>Once finish implementing, you can run the algorithm in two different ways. The first one is using your local simulator, which utilizes the computing power of your CPU. This is certainly not the target of quantum computing, but it&rsquo;s really convenient that you can check your algorithm accuracy for a small number of qubits. The second way is borrowing computing power of quantum devices available for public use from large players in the field (IBM, Rigetti to name a few). Unfortunately, because we still rest at an era called Noisy-Intermediate Scale Quantum (NISQ), so you shouldn&rsquo;t expect much from the performance of those public quantum computers.</p>

<p>The two chunks of code below show the difference in implementations and results betweeb using a simulator and a IBM&rsquo;s quantum computer.
 <table class="highlighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%"><code class="language-python" data-lang="python">1
2
3
4
5
6
7
8</code></pre></div></td><td class="code"><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><code class="language-python" data-lang="python"><span></span><span style="color: #75715e"># use local simulator</span>
<span style="color: #f8f8f2">backend</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">BasicAer</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">get_backend(</span><span style="color: #e6db74">&#39;qasm_simulator&#39;</span><span style="color: #f8f8f2">)</span>
<span style="color: #f8f8f2">shots</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">1024</span>
<span style="color: #f8f8f2">job</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">execute(bvCircuit,</span> <span style="color: #f8f8f2">backend</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">backend,</span> <span style="color: #f8f8f2">shots</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">shots)</span>
<span style="color: #f8f8f2">job_monitor(job)</span>
<span style="color: #f8f8f2">result</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">job</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">result()</span>
<span style="color: #f8f8f2">answer</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">result</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">get_counts()</span>
<span style="color: #f8f8f2">plot_histogram(answer)</span> 
</code></pre></div>
</td></tr></table>
<img src="/uploads/Bernstein-Vazirani Algorithm/simulator result.png" alt="Example image" /></p>

<p><table class="highlighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%"><code class="language-python" data-lang="python">1
2
3
4
5
6
7
8</code></pre></div></td><td class="code"><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><code class="language-python" data-lang="python"><span></span><span style="color: #75715e"># use IBMQ device</span>
<span style="color: #f8f8f2">backend</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">IBMQ</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">get_backend(</span><span style="color: #e6db74">&#39;ibmq_16_melbourne&#39;</span><span style="color: #f8f8f2">)</span>
<span style="color: #f8f8f2">shots</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">1024</span>
<span style="color: #f8f8f2">job</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">execute(bvCircuit_alternative,</span> <span style="color: #f8f8f2">backend</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">backend,</span> <span style="color: #f8f8f2">shots</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">shots)</span>
<span style="color: #f8f8f2">job_monitor(job)</span>
<span style="color: #f8f8f2">result</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">job</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">result()</span>
<span style="color: #f8f8f2">answer</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">result</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">get_counts()</span>
<span style="color: #f8f8f2">plot_histogram(answer)</span> 
</code></pre></div>
</td></tr></table>
<img src="/uploads/Bernstein-Vazirani Algorithm/quantum result.png" alt="Example image" /></p>

<p>You see the result&hellip; The correct result not even shows up once out of $1024$ times (You can check dictionary &ldquo;answer&rdquo; on your own). Merely outputing random strings, it can&rsquo;t be any worse. The main reason for this phenomenon comes from the fact <strong>CNOT</strong> gates belong to the set of multiqubit operators and are difficult to engineered precisely. Still, there are tons of technical barriers we must confront ahead. However, there is a brighter, instant way for us to improve our computation performance: A circuit without multiqubit gates definitely results in a better outcome. That&rsquo;s what I want to introduce in the next section.</p>

<h4 id="alternative-circuit-design">Alternative circuit design</h4>

<p>Before diving into a new circuit design for the algorithm, you should keep in mind that THE LESS CONTROL GATES THE CIRCUIT HAS, THE MORE PRECISE ITS OUTCOME CAN BE. So, our purpose is to create an circuit with all gates being single-qubit.</p>

<p><img src="/uploads/Bernstein-Vazirani Algorithm/BV circuit.png" alt="Example image" />
In terms of the circuit above, looking back all the states $|\psi\rangle$ calculated in <a href="/en/2019/05/bernstein-vazirani-algorithm-part-1-a-derivation-of-the-deutsch-jozsa-algorithm/">Part 2</a>, we notice that the ancilla qubit is always kept in the state $\frac{|0\rangle - |1\rangle}{\sqrt{2}}$:
$$|\psi_0\rangle = |0\rangle^{\otimes n} \left( \frac{|0\rangle - |1\rangle}{\sqrt{2}}\right)$$
$$|\psi_1\rangle = \frac{1}{\sqrt{2^n}}\sum_{\mathbf{x} \in \{0,1\}^n} |\mathbf{x}\rangle \left( \frac{|0\rangle - |1\rangle}{\sqrt{2}}\right)$$
$$|\psi_2\rangle = \frac{1}{\sqrt{2^n}} \sum_{\mathbf{x} \in \{0,1\}^n} (-1)^{\mathbf{s}\cdot\mathbf{x}} |\mathbf{x}\rangle \left( \frac{|0\rangle - |1\rangle}{\sqrt{2}} \right)$$
$$|\psi_3\rangle = \frac{1}{\sqrt{2^n}} \sum_{\mathbf{z} \in \{0,1\}^n} (-1)^{\mathbf{s}\cdot\mathbf{x} \oplus \mathbf{x}\cdot\mathbf{z}} |\mathbf{z}\rangle \left( \frac{|0\rangle - |1\rangle}{\sqrt{2}} \right)$$</p>

<p>If the ancilla stays constant throughout calculation, is it really meaningful? Is it possible to eliminate the ancilla from our equation? The answer turns out to be yes. In fact, the ancilla serves the only purpose of phase kick-back whose effect can be summerized in one equation:
$$U_f: |x\rangle \left( \frac{|0\rangle - |1\rangle}{\sqrt{2}} \right) \mapsto (-1)^{f(x)} |x\rangle \left( \frac{|0\rangle - |1\rangle}{\sqrt{2}} \right)$$
As long as we can produce $(-1)^{f(x)} |x\rangle$, it&rsquo;s no point to keep the ancilla. A single-qubit operator that is able to reverse the sign with regard to the value of $f(x)$ is <strong>Z</strong> gate. Having the matrix form of $\begin{bmatrix}
1 &amp; 0\\
0 &amp; -1
\end{bmatrix}$, it keeps the state $|0\rangle$ unchanged and transforms $|1\rangle$ into $-|1\rangle$. We can redo the same procedure in the sections above: finding out every $\mathbf{x}$ that $f(\mathbf{x})=1$ and apply the <strong>Z</strong> gate to those positions. The code doesn&rsquo;t change much:
 <table class="highlighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%"><code class="language-python" data-lang="python"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</code></pre></div></td><td class="code"><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><code class="language-python" data-lang="python"><span></span><span style="color: #66d9ef">def</span> <span style="color: #a6e22e">alternativeCircuit</span><span style="color: #f8f8f2">(nQubits,</span> <span style="color: #f8f8f2">s):</span>
    
    <span style="color: #f8f8f2">qr</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">QuantumRegister(nQubits)</span>
    <span style="color: #f8f8f2">cr</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">ClassicalRegister(nQubits)</span>
    <span style="color: #f8f8f2">circuitName</span> <span style="color: #f92672">=</span> <span style="color: #e6db74">&quot;BernsteinVazirani&quot;</span>
    <span style="color: #f8f8f2">bvCircuit</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">QuantumCircuit(qr,</span> <span style="color: #f8f8f2">cr)</span>
    
    <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(nQubits):</span>
        <span style="color: #f8f8f2">bvCircuit</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">h(qr[i])</span>
    <span style="color: #f8f8f2">bvCircuit</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">barrier()</span>
    
    <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(nQubits):</span>
        <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(s</span> <span style="color: #f92672">&amp;</span> <span style="color: #f8f8f2">(</span><span style="color: #ae81ff">1</span> <span style="color: #f92672">&lt;&lt;</span> <span style="color: #f8f8f2">i)):</span>
            <span style="color: #f8f8f2">bvCircuit</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">z(qr[i])</span>
    <span style="color: #f8f8f2">bvCircuit</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">barrier()</span>
    
    <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">i</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">range(nQubits):</span>
        <span style="color: #f8f8f2">bvCircuit</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">h(qr[i])</span>
    <span style="color: #f8f8f2">bvCircuit</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">barrier(qr)</span>
    
    <span style="color: #f8f8f2">bvCircuit</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">measure(qr,cr)</span>
    
    <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">bvCircuit</span> 
</code></pre></div>
</td></tr></table></p>

<p>Initializing and running the circuit on the realized quantum device used the original circuit:
 <table class="highlighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%"><code class="language-python" data-lang="python">1
2
3</code></pre></div></td><td class="code"><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><code class="language-python" data-lang="python"><span></span><span style="color: #f8f8f2">nQubits</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">13</span>
<span style="color: #f8f8f2">s</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">101</span>
<span style="color: #f8f8f2">bvCircuit_alternative</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">alternativeCircuit(nQubits,</span> <span style="color: #f8f8f2">s)</span> 
</code></pre></div>
</td></tr></table></p>

<table class="highlighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%"><code class="language-python" data-lang="python">1
2
3
4
5
6
7
8</code></pre></div></td><td class="code"><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><code class="language-python" data-lang="python"><span></span><span style="color: #75715e"># use IBMQ device</span>
<span style="color: #f8f8f2">backend</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">IBMQ</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">get_backend(</span><span style="color: #e6db74">&#39;ibmq_16_melbourne&#39;</span><span style="color: #f8f8f2">)</span>
<span style="color: #f8f8f2">shots</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">1024</span>
<span style="color: #f8f8f2">job</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">execute(bvCircuit_alternative,</span> <span style="color: #f8f8f2">backend</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">backend,</span> <span style="color: #f8f8f2">shots</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">shots)</span>
<span style="color: #f8f8f2">job_monitor(job)</span>
<span style="color: #f8f8f2">result</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">job</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">result()</span>
<span style="color: #f8f8f2">answer</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">result</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">get_counts()</span>
<span style="color: #f8f8f2">plot_histogram(answer)</span> 
</code></pre></div>
</td></tr></table>

<p>Here&rsquo;s the result
<img src="/uploads/Bernstein-Vazirani Algorithm/alternative result.png" alt="Example image" />
The code chunk below is for extracting the correct value of $\mathbf{s}$, which is the bitstring of highest possibility in the chart.
 <table class="highlighttable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%"><code class="language-python" data-lang="python">1
2</code></pre></div></td><td class="code"><div class="highlight" style="background: #272822"><pre style="line-height: 125%"><code class="language-python" data-lang="python"><span></span><span style="color: #f92672">import</span> <span style="color: #f8f8f2">operator</span>
<span style="color: #f8f8f2">max(answer</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">items(),</span> <span style="color: #f8f8f2">key</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">operator</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">itemgetter(</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">))</span> 
</code></pre></div>
</td></tr></table></p>

<p>Although the chart still shows a tremedously errorneous result, at least the correct outcome stays distinguishable from other wrong outcomes. From all the examples in this article, I hope you got a basic understanding of Qiskit and real quantum computers. Quantumly performing an algorithm is a way to help figure out what can be done and what is yet to be done in the quantum realm. Again, feel free to explore my code stored in my GitHub repository.</p>

<blockquote>
<p>My little suggestion: Take a look at Transpiler, a special class for quantum hardware optimization.</p>
</blockquote>
    
        </div>
    </section>

    <footer class="post-full-footer">
      <section class="author-card">
        <img class="author-profile-image" src="https://myentangled.com/uploads/profile.jpg" alt="Author" />
        <section class="author-card-content">
            <h4 class="author-card-name"><a href="/en/">Entangled Cat</a></h4>
                <p>I work hard so that my cats can live a better live</p>
        </section>
      </section>
    </footer>
</article>
    
    
    

  </div>
</main>


<aside class="read-next outer">
  <div class="inner">
    <div class="read-next-feed">      
      
<article class="read-next-card" 
            style="background-image: url(https://myentangled.com/uploads/cover%20blog.png);" >
    <header class="read-next-card-header">
        <small class="read-next-card-header-sitetitle">&mdash;  &mdash;</small>
        
        <h3 class="read-next-card-header-title"><a href="/en/tags/project/">#project</a></h3>
    </header>
    <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
    </div>

    <div class="read-next-card-content">
      
        <ul>
          <li><a href="https://myentangled.com/en/2019/05/deutsch-algorithm-part-1-kicking-the-phase-back/">Deutsch Algorithm (Part 1): Kicking the phase back</a></li>            
        
          <li><a href="https://myentangled.com/en/2019/03/a-half-alive-half-dead-cat-and-the-beginning-of-quantum-information/">A half-alive-half-dead cat and the beginning of Quantum Information</a></li>            
        
          <li><a href="https://myentangled.com/en/2019/03/qubits-the-substitution-of-bits-in-quantum-scenario/">Qubits: The substitution of bits in quantum scenario</a></li>            
        
          <li><a href="https://myentangled.com/en/2019/08/myentangled-index-my-suggested-order-of-reading/">MyEntangled index: my suggested order of reading</a></li>            
        </ul>
    </div>
    <footer class="read-next-card-footer">
      
        <a href="/en/tags/project/">See all related posts →</a>
    </footer>
</article>


      
      <article class="post-card post"> 
    
    <a class="post-card-image-link" href="https://myentangled.com/en/2019/07/mixed-states-and-general-quantum-operations-a-simple-view-on-the-framework-of-quantum-mechanics/">
      <div class="post-card-image" style="background-image: url(https://myentangled.com/uploads/Mixed%20State/cover.png)"></div>
    </a>
    

    <div class="post-card-content">
      <a class="post-card-content-link" href="https://myentangled.com/en/2019/07/mixed-states-and-general-quantum-operations-a-simple-view-on-the-framework-of-quantum-mechanics/">
          <header class="post-card-header">
              <span class="post-card-tags">
              #Mixed States 
              #Density Operator  </span>
              
              <h2 class="post-card-title">Mixed States and General Quantum Operations: A simple view on the framework of Quantum Mechanics</h2>
          </header>
          <section class="post-card-excerpt">
              
                <p>In this text I&rsquo;ll do some review on the definition of quantum state and quantum measurement, which was introduced here, and reasonably expand the notions into the most general instances of quantum bits.
Review Given a state $$|\psi\rangle = \sum_i \alpha_i |\varphi_i \rangle,$$ it&rsquo;s possible to perform a Von Neumann measurement on the state&rsquo;s space $\mathscr{H}$ with respect to the orthonormal basis $B = \{|\varphi_i \rangle\}$. The output would be a label $i$ with corresponding probability $|\alpha_i|^2$ and the system left in state $|\varphi_i\rangle$. ...  </p>
              
          </section>
      </a>

      <footer class="post-card-meta">
          <img class="author-profile-image" src="https://myentangled.com/uploads/profile.jpg" alt="Author" />
          <span class="post-card-author"><a href="/">Entangled Cat</a></span>
      </footer>
    </div>
</article>
      
      
      <article class="post-card post"> 
    
    <a class="post-card-image-link" href="https://myentangled.com/en/2019/05/bernstein-vazirani-algorithm-part-1-a-derivation-of-the-deutsch-jozsa-algorithm/">
      <div class="post-card-image" style="background-image: url(https://myentangled.com/uploads/Bernstein-Vazirani%20Algorithm/cat%20cover.jpg)"></div>
    </a>
    

    <div class="post-card-content">
      <a class="post-card-content-link" href="https://myentangled.com/en/2019/05/bernstein-vazirani-algorithm-part-1-a-derivation-of-the-deutsch-jozsa-algorithm/">
          <header class="post-card-header">
              <span class="post-card-tags">
              #Bernstein-Vazirani algorithm 
              #Deutsch algorithm  </span>
              
              <h2 class="post-card-title">Bernstein-Vazirani algorithm (Part 1): A derivation of the Deutsch-Jozsa algorithm</h2>
          </header>
          <section class="post-card-excerpt">
              
                <p>Here we stop by Berstein-Vazirani problem that inherents the structure of its predecessor, Deutsch-Jozsa problem, before we can get started with problems and solutions of practical meaning later. Because this problem is similar to the one stated in the last series, we&rsquo;ll get straight to it.
Berstein-Vazirani problem The access for a black-box function $f: \{0,1\}^n \mapsto \{0,1\}$. It&rsquo;s guaranteed that $f(\mathbf{x}) = \mathbf{s}\cdot\mathbf{x}$ (mod $2$) for some secret string $\mathbf{s} \in \{0,1\}^n$. ...  </p>
              
          </section>
      </a>

      <footer class="post-card-meta">
          <img class="author-profile-image" src="https://myentangled.com/uploads/profile.jpg" alt="Author" />
          <span class="post-card-author"><a href="/">Entangled Cat</a></span>
      </footer>
    </div>
</article>
      
    </div>
  </div>
</aside>

<div class="floating-header">
  <div class="floating-header-logo">
    <a href="https://myentangled.com/">
      
      <span>My Entangled: Blogging on Quantum Information, Quantum Algorithms and Quantum Computing</span>
    </a>
  </div>
  <span class="floating-header-divider">&mdash;</span>
  <div class="floating-header-title">Bernstein-Vazirani algorithm (Part 2): How to run your algorithms on a realistic quantum computer</div>
  <div class="floating-header-share">
    <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
     <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/></svg>
    </div>
    
    <a class="floating-header-share-tw" href="https://twitter.com/share?text=Bernstein-Vazirani%20algorithm%20%28Part%202%29%3a%20How%20to%20run%20your%20algorithms%20on%20a%20realistic%20quantum%20computer&amp;url=https%3a%2f%2fmyentangled.com%2fen%2f2019%2f06%2fbernstein-vazirani-algorithm-part-2-how-to-run-your-algorithms-on-a-realistic-quantum-computer%2f"
          onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
      </a>
      <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmyentangled.com%2fen%2f2019%2f06%2fbernstein-vazirani-algorithm-part-2-how-to-run-your-algorithms-on-a-realistic-quantum-computer%2f"
          onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>
      </a>
  </div>

  <progress class="progress" value="0">
    <div class="progress-container">
      <span class="progress-bar"></span>
    </div>
  </progress>
</div>



<footer class="site-footer outer">
  <div class="site-footer-content inner">
    <section class="copyright" style="line-height: 1.3em;">
      <a href="/"></a>  <br>
      
    </section>
    <nav class="site-footer-nav">
        <a href="/">Latest Posts</a>
        
        <a href="https://twitter.com/TrongDu81761446" target="_blank" rel="noopener">Twitter</a>
        <a href="https://github.com/myentangled" target="_blank" rel="noopener">Github</a>
        <a href="https://www.linkedin.com/in/trong-duong-0a75b6171" target="_blank" rel="noopener">LinkedIn</a>
        
    </nav>  
  </div>

</footer>

</div>
<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
<script type="text/javascript" src="//code.jquery.com/jquery-3.2.1.min.js"></script>
<script type="text/javascript" src="https://myentangled.com/js/jquery.fitvids.js"></script>

<script>hljs.initHighlightingOnLoad();</script>


  <!-- Google Analytics -->
  <script>
    var _gaq=[['_setAccount','UA-140823575-1'],['_trackPageview']];
    (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
    g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g,s)}(document,'script'));
  </script>


    <script>





$(document).ready(function () {
    
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>
</body></html>
